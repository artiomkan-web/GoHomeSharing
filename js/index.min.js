"use strict";window.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector(".startpage__city"),t=e.querySelector(".startpage__city__title"),a=(e.querySelector(".startpage__city__list"),e.querySelectorAll(".startpage__city__list-item"));t.addEventListener("click",()=>{e.classList.toggle("active")}),document.body.addEventListener("click",t=>{t.target.classList[0]&&(t.target.classList[0].includes("startpage__city")||e.classList.remove("active"))}),a.forEach(a=>{a.addEventListener("click",()=>{t.querySelector("span").textContent=a.textContent,e.classList.toggle("active")})});let i=document.querySelector(".startpage__subway"),r=i.querySelector(".startpage__subway__title"),n=(i.querySelector(".startpage__subway__list"),i.querySelectorAll(".startpage__subway__list-item"));r.addEventListener("click",()=>{i.classList.toggle("active")}),document.body.addEventListener("click",e=>{e.target.classList[0]&&(e.target.classList[0].includes("startpage__subway")||i.classList.remove("active"))}),n.forEach(e=>{e.addEventListener("click",()=>{r.textContent=e.textContent,i.classList.toggle("active")})});let s=document.querySelectorAll(".startpage__filter__price__list-item"),l=document.querySelectorAll(".startpage__filter__data ");s.forEach(e=>{e.addEventListener("click",()=>{for(let t=0;t<s.length;t++)s[t]==e?(s[t].classList.add("active"),l[t].classList.add("active")):(s[t].classList.remove("active"),l[t].classList.remove("active"))})}),document.querySelectorAll(".dropdown").forEach(e=>{e.querySelector(".dropdown__title").addEventListener("click",()=>{e.classList.toggle("active")}),e.querySelectorAll(".dropdown__list-item").forEach(e=>{e.addEventListener("click",()=>{e.classList.toggle("active")})})}),document.querySelectorAll(".startpage__filter__additional__list-item").forEach(e=>{e.addEventListener("click",t=>{e.classList.toggle("active")})});let c=document.querySelector(".startpage__timer__clock"),o=document.querySelector(".startpage__timer__all-line"),d=document.querySelector(".startpage__timer__all-line__circle");d.setAttribute("r",getComputedStyle(o).width.split("px")[0]/2);let _=d.r.baseVal.value,u=parseInt(2*Math.PI*_+1),h=100;function m(e){let t=u-e/100*u;d.style.strokeDashoffset=t}function g(e){return e.toString().length<2&&(e="0"+e),e}d.style.strokeDasharray=`${u} ${u}`,d.style.strokeDashoffset=u,m(0),setInterval(()=>{let e=moment(Date.now())._d,t=(+moment(new Date(e.getFullYear(),e.getMonth(),e.getDate()+1,0))._d-+e)/1e3,a=Math.floor(t/3600%24),i=Math.floor(t/60%60),r=Math.floor(t%60);r=g(r),i=g(i),c.textContent=a+":"+i+":"+r,h>0&&(h-=5,m(t/86400*100))},1e3);class v{constructor(e,t=new Date,a=0){this.element=e,this.date=new Date,this.activeDate=t,this.minDuration=a,this.months=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],this.monthsTitles=["Января","Февраля","Марта","Апреля","Мая","Июня","Июля","Августа","Сентября","Октября","Ноября","Декабря"],this.element.querySelector(".calendar__actual-time")&&(this.element.querySelector(".calendar__timepicker").value=this.beautyValue((new Date).getHours()+1)+":00",this.element.querySelector(".calendar__actual-time").addEventListener("click",()=>{let e=this.beautyValue((new Date).getHours()),t=this.beautyValue((new Date).getMinutes());this.element.querySelector(".calendar__timepicker").value=e+":"+t,this.element.querySelector(".calendar__btn__time").innerHTML=e+":"+t})),this.element.querySelector(".calendar__actual-date")&&this.element.querySelector(".calendar__actual-date").addEventListener("click",()=>{this.renderCalendar(this.element),this.activeDate.setDate((new Date).getDate()),this.activeDate.setMonth((new Date).getMonth()),this.activeDate.setFullYear((new Date).getFullYear()),this.element.querySelector(".calendar__date>p").innerHTML=this.beautyValue(this.activeDate.getDate())+" "+this.beautyValue(this.monthsTitles[this.activeDate.getMonth()])+" "+this.activeDate.getFullYear(),this.element.querySelector(".calendar__btn__date").innerHTML=this.beautyValue(this.activeDate.getDate())+"."+this.beautyValue(this.activeDate.getMonth()+1)+"."+this.activeDate.getFullYear(),this.correctTime()}),this.element.querySelector(".calendar__timepicker")&&this.element.querySelector(".calendar__timepicker").addEventListener("input",e=>{this.element.querySelector(".calendar__btn__time").innerHTML=e.target.value,this.correctTime()}),this.element.querySelector(".calendar__prev").addEventListener("click",()=>{this.date.setMonth(this.date.getMonth()-1),this.activeDate.setMonth(this.date.getMonth()-1),this.activeDate.setFullYear(this.date.getFullYear()),this.activeDate.getMonth()>(new Date).getMonth()-2||this.activeDate.getFullYear()>(new Date).getFullYear()?this.renderCalendar(this.element):(this.date.setMonth((new Date).getMonth()),this.activeDate.setMonth((new Date).getMonth()))}),this.element.querySelector(".calendar__next").addEventListener("click",()=>{this.date.setMonth(this.date.getMonth()+1),this.activeDate.setMonth(this.date.getMonth()-1),this.renderCalendar(this.element)}),e.querySelector(".calendar__btn__date").innerHTML=this.beautyValue(this.activeDate.getDate())+"."+this.beautyValue(this.activeDate.getMonth()+1)+"."+this.activeDate.getFullYear(),e.querySelector(".calendar__btn__time")&&(e.querySelector(".calendar__btn__time").innerHTML=this.activeDate.getHours()+1+":00"),this.renderCalendar(this.element)}renderCalendar(e){this.date.setDate(1),this.monthDays=e.querySelector(".calendar__days"),this.lastDay=new Date(this.date.getFullYear(),this.date.getMonth()+1,0).getDate(),this.prevLastDay=new Date(this.date.getFullYear(),this.date.getMonth(),0).getDate(),this.firstDayIndex=this.date.getDay(),this.lastDayIndex=new Date(this.date.getFullYear(),this.date.getMonth()+1,0).getDay(),this.nextDays=7-this.lastDayIndex-1,this.days="",e.querySelector(".calendar__date>span").innerHTML=this.months[this.date.getMonth()],e.querySelector(".calendar__date>p").innerHTML=(new Date).getDate()+" "+this.monthsTitles[(new Date).getMonth()]+" "+(new Date).getFullYear();for(let e=this.firstDayIndex-1+this.minDuration;e>0;e--)this.days+=`<div class="calendar__prev-date">${this.prevLastDay-e+1}</div>`;for(let e=1;e<=this.lastDay;e++)e===(new Date).getDate()&&this.date.getMonth()===(new Date).getMonth()?this.days+=`<div class="active">${e+this.minDuration}</div>`:this.days+=`<div>${e+this.minDuration}</div>`;for(let e=1;e<=this.nextDays+1;e++)this.days+=`<div class="calendar__next-date">${e}</div>`,this.monthDays.innerHTML=this.days;this.days=e.querySelectorAll(".calendar__days>div"),this.days.forEach(e=>{1*e.textContent<(new Date).getDate()+this.minDuration&&this.date.getMonth()==(new Date).getMonth()&&this.date.getFullYear()==(new Date).getFullYear()&&e.classList.add("calendar__prev-date")}),this.days.forEach(t=>{t.addEventListener("click",a=>{t.classList.contains("calendar__prev-date")&&t.classList.contains("calendar__next-date")||(this.days.forEach(e=>{e.classList.remove("active")}),t.classList.add("active"),e.querySelector(".calendar__date>p").innerHTML=t.textContent+" "+this.monthsTitles[this.date.getMonth()]+" "+this.date.getFullYear(),this.activeDate.setDate(t.textContent),this.activeDate.setMonth(this.date.getMonth()),this.activeDate.setFullYear(this.date.getFullYear()),e.querySelector(".calendar__btn__date").innerHTML=this.beautyValue(this.activeDate.getDate())+"."+this.beautyValue(this.activeDate.getMonth()+1)+"."+this.activeDate.getFullYear(),this.correctTime())})})}beautyValue(e){return e.toString().length<2&&(e="0"+e),e}correctTime(){let e=(new Date).getDate()+":"+(new Date).getMonth()+":"+(new Date).getFullYear(),t=this.activeDate.getDate()+":"+this.activeDate.getMonth()+":"+this.activeDate.getFullYear(),a=(new Date).getHours(),i=null,r=(new Date).getMinutes(),n=null;this.element.querySelector(".calendar__timepicker")&&(i=1*this.element.querySelector(".calendar__timepicker").value.split(":")[0],n=1*this.element.querySelector(".calendar__timepicker").value.split(":")[1]),(e==t&&i<=a&&n<r||e==t&&i<a)&&(this.element.querySelector(".calendar__timepicker").value=a+":"+r,this.element.querySelector(".calendar__btn__time").innerHTML=a+":"+r)}}let y={start:+(new Date).setHours((new Date).getHours()+1,0),end:+(new Date).setHours((new Date).getHours()+1,30),interval:1,duration:30,min:30},D=document.querySelector(".startpage__filter__data.mins"),S=D.querySelector(".time_start>.clock__btn.add"),q=D.querySelector(".time_start>.clock__btn.remove"),p=D.querySelector(".time_end>.clock__btn.add"),L=D.querySelector(".time_end>.clock__btn.remove"),M=D.querySelector(".time_start>.clock__value>.clock__hours"),k=D.querySelector(".time_start>.clock__value>.clock__minutes"),w=D.querySelector(".time_end>.clock__value>.clock__hours"),f=D.querySelector(".time_end>.clock__value>.clock__minutes"),E=D.querySelector(".time_duration"),x=D.querySelector(".calendar"),H={start:+(new Date).setHours((new Date).getHours()+1,0),end:+(new Date).setHours((new Date).getHours()+2,0),interval:1,duration:1,min:1},b=document.querySelector(".startpage__filter__data.hours"),T=b.querySelector(".time_start>.clock__btn.add"),F=b.querySelector(".time_start>.clock__btn.remove"),Y=b.querySelector(".time_end>.clock__btn.add"),C=b.querySelector(".time_end>.clock__btn.remove"),A=b.querySelector(".time_start>.clock__value>.clock__hours"),V=b.querySelector(".time_start>.clock__value>.clock__minutes"),I=b.querySelector(".time_end>.clock__value>.clock__hours"),P=b.querySelector(".time_end>.clock__value>.clock__minutes"),j=b.querySelector(".time_duration"),O=b.querySelector(".calendar");function W(){return H.duration=(H.end-H.start)/1e3/3600,y.duration}function z(){let e=moment(H.start)._d.getHours(),t=moment(H.start)._d.getMinutes(),a=moment(H.end)._d.getHours(),i=moment(H.end)._d.getMinutes();t.toString().length<2&&(t="0"+t),i.toString().length<2&&(i="0"+i),A.innerHTML=e,V.innerHTML=t,I.innerHTML=a,P.innerHTML=i,j.innerHTML=H.duration}W(),T.addEventListener("click",()=>{H.start+=1e3*H.interval*3600,W(),H.duration<1&&(H.end+=1e3*H.interval*3600,W(),0==moment(H.end)._d.getHours()&&0==moment(H.end)._d.getMinutes()&&(H.end-=100*H.interval*3600,H.start-=100*H.interval*3600,W())),z()}),F.addEventListener("click",()=>{H.start-=1e3*H.interval*3600,W(),moment(H.start)._d.getHours()>moment(H.end)._d.getHours()&&(H.start=H.end-(H.duration-1)*H.interval*1e3*3600,W()),z()}),Y.addEventListener("click",()=>{H.end+=1e3*H.interval*3600,W(),moment(H.start)._d.getHours()+H.duration>24&&(H.end=H.start+(H.duration-1)*H.interval*1e3*3600,W()),z()}),C.addEventListener("click",()=>{H.end-=1e3*H.interval*3600,W(),H.duration<1&&(H.end+=1e3*H.interval*3600,W()),z()}),z();let B=new Date;B.setDate((new Date).getDate()+1),[[document.querySelector(".startpage__filter__data.mins>.calendar")],[document.querySelector(".startpage__filter__data.hours>.calendar")],[document.querySelector(".startpage__filter__data.days>.calendar.start")],[document.querySelector(".startpage__filter__data.days>.calendar.end"),B,1]].forEach(e=>{new v(e[0],e[1],e[2]),e[0].querySelector(".calendar__btn").addEventListener("click",()=>{e[0].classList.toggle("active")}),$(document).mouseup((function(t){var a=$(e[0]);0===a.has(t.target).length&&a.removeClass("active")}))});let G=new Date($.now()),J=O.querySelector(".calendar__btn");function K(){return y.duration=(y.end-y.start)/1e3/60,y.duration}function N(){let e=moment(y.start)._d.getHours(),t=moment(y.start)._d.getMinutes(),a=moment(y.end)._d.getHours(),i=moment(y.end)._d.getMinutes();t.toString().length<2&&(t="0"+t),i.toString().length<2&&(i="0"+i),M.innerHTML=e,k.innerHTML=t,w.innerHTML=a,f.innerHTML=i,E.innerHTML=y.duration}$(J).val(G.toLocaleDateString()),$(J).datepicker({minDate:G,onSelect:function(e,t){""!=e&&(J.value=e)}}),K(),S.addEventListener("click",()=>{y.start+=1e3*y.interval*60,K(),y.duration<30&&(y.end+=1e3*y.interval*60,K(),0==moment(y.end)._d.getHours()&&0==moment(y.end)._d.getMinutes()&&(y.end-=1e3*y.interval*60,y.start-=1e3*y.interval*60,K())),N()}),q.addEventListener("click",()=>{y.start-=1e3*y.interval*60,K(),23==moment(y.start)._d.getHours()&&59==moment(y.start)._d.getMinutes()&&(y.start+=1e3*y.interval*60,K()),N()}),p.addEventListener("click",()=>{y.end+=1e3*y.interval*60,K(),0==moment(y.end)._d.getHours()&&0==moment(y.end)._d.getMinutes()&&(y.end-=1e3*y.interval*60,K()),N()}),L.addEventListener("click",()=>{y.end-=1e3*y.interval*60,K(),y.duration<30&&(y.end+=1e3*y.interval*60,K(),alert("Минимальное время: 30 минут")),N()}),N();let Q=new Date($.now()),R=x.querySelector(".startpage__filter__data-item.calendar>.calendar__btn");$(R).val(Q.toLocaleDateString()),$(R).datepicker({minDate:Q,onSelect:function(e,t){""!=e&&(R.name=e)}});class U{constructor(e,t=0){this.slider=e,this.row=e.querySelector(".slider__row"),this.items=e.querySelectorAll(".slider__item"),this.indents=1*getComputedStyle(this.slider).getPropertyValue("--indents").split("px")[0],this.quantity=1*getComputedStyle(this.slider).getPropertyValue("--quantity"),this.prev=e.querySelector(".slider__toggle.prev"),this.next=e.querySelector(".slider__toggle.next"),this.dots=e.querySelectorAll(".slider__dots-item"),this.index=0,this.interval=t,this.next&&this.next.addEventListener("click",()=>{this.index++,this.toggleSlider()}),this.prev&&this.prev.addEventListener("click",()=>{this.index--,this.toggleSlider()}),this.dots&&this.dots.forEach(e=>{e.addEventListener("click",e=>{for(let t=0;t<this.dots.length;t++)this.dots[t]===e.target?(this.dots[t].classList.add("active"),this.index=t,this.toggleSlider()):this.dots[t].classList.remove("active")})}),this.interval>0&&setInterval(()=>{this.index++,this.toggleSlider()},this.interval)}toggleSlider(){this.index>this.items.length-this.quantity&&(this.index=0),this.index<0&&(this.index=this.items.length-this.quantity),this.dots&&(this.dots.forEach(e=>{e.classList.remove("active")}),this.dots[this.index].classList.add("active")),this.row.style.left=-this.index*(this.items[0].offsetWidth+this.indents)+"px"}}document.querySelectorAll(".apartments__item__slider").forEach(e=>{new U(e)}),document.querySelectorAll(".apartments__item__favorite").forEach(e=>{e.addEventListener("click",()=>{e.classList.toggle("active")})});let X=document.querySelector(".apartments"),Z=document.querySelector(".apartments__map"),ee=X.offsetTop,te=document.querySelectorAll(".show-type"),ae="list",ie=document.querySelector(".startpage__results-item.type_toggle");ie.addEventListener("click",()=>{"list"==ae?(ie.textContent="Список",ae="map",te[0].classList.add("active"),te[1].classList.remove("active"),Z.style.marginTop=-ee+"px",X.style.padding="0"):(ae="list",ie.textContent="На карте",te[0].classList.remove("active"),te[1].classList.add("active"),X.style.padding="")});let re=document.querySelector(".work__steps");new U(re,5e3);!function(){if(window.matchMedia("(max-width: 768px)").matches){let t=document.querySelector(".startpage__filter"),a=document.querySelector(".startpage__filter__title"),r=document.querySelector(".startpage__filter__list");a.addEventListener("click",()=>{t.classList.toggle("active")}),r.insertAdjacentElement("afterbegin",i);let n=document.querySelector(".apartments"),s=n.querySelector(".apartments__list"),l=n.querySelector(".apartments__list-container"),c=n.querySelectorAll(".apartments__item"),o=n.querySelector(".apartments__toggle-btn.prev"),d=n.querySelector(".apartments__toggle-btn.next"),_=getComputedStyle(s).getPropertyValue("--indents").split("px")[0],u=0;function e(){u<0&&(u=c.length-1),u>c.length-1&&(u=0),l.style.left=`calc(${100*-u}% - ${u*_}px)`}o.addEventListener("click",()=>{u--,e()}),d.addEventListener("click",()=>{u++,e()})}window.matchMedia("(max-width: 480px)").matches}()});